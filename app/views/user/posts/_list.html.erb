<% posts.each_slice(1) do |posts| %>
<section>
  <div class="row mt-5">
    <ul>
      <% posts.each do |post| %>
        <div class="col-lg-12 text-center text-white toukou">
          <p>
            <%= image_tag post.user.get_profile_image(50,50), class: "rounded-circle" %>
            <%= post.user.name %>
            <%= post.created_at.strftime('%Y/%m/%d') %>
          </p>

          <%= link_to post_path(post.id) do %>
            <%= image_tag post.get_image, :size =>'200x150' %>
          <% end %>

          <p><%= post.title %></p>
          <p><%= post.body %></p>
          <div id="waveform_<%= post.id %>">
            <!-- the waveform will be rendered here -->
          </div>
          <script>
            const wavesurfer_<%= post.id %> = WaveSurfer.create({
              container: '#waveform_<%= post.id %>',
              waveColor: 'white',
              progressColor: '#EDFFBE',
              url: '<%= post.audio.url %>',
            })
          </script>
          <button onclick="wavesurfer_<%= post.id %>.playPause()">再生・停止</button>

          <% post.tags.each do |tag| %>
            <%= tag.tag_type %>
          <% end %>

          <p>
            <%= link_to post_path(post.id), method: :get do %>
              <i class="fa-regular fa-comment" style="color: #ffffff8a;"></i><%= post.post_comments.count %>
            <% end %>

            <% if post.favorited_by?(current_user) %>
              <%= link_to post_favorites_path(post), method: :delete do %>
                <i class="fa-solid fa-heart" style="color: #ff2a2a;"></i><%= post.favorites.count %>
              <% end %>
              <% else %>
              <%= link_to post_favorites_path(post), method: :post do %>
                <i class="fa-regular fa-heart" style="color: #ff2a2a;"></i><%= post.favorites.count %>
              <% end %>
            <% end %>
          </p>
          <div id="waveform_<%= post.id %>"></div>
        </div>
      <% end %>
    </ul>
  </div>
</section>
<% end %>
